(function(t){function e(e){for(var o,r,n=e[0],l=e[1],c=e[2],u=0,m=[];u<n.length;u++)r=n[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);d&&d(e);while(m.length)m.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],o=!0,n=1;n<a.length;n++){var l=a[n];0!==i[l]&&(o=!1)}o&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var o={},i={app:0},s=[];function r(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=o,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(a,o,function(e){return t[e]}.bind(null,o));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);var o=a("2b0e"),i=a("7496"),s=a("40dc"),r=a("5bc1"),n=a("8336"),l=a("b0af"),c=a("99d9"),d=a("169a"),u=a("132d"),m=a("8860"),p=a("da13"),h=a("1800"),f=a("5d23"),v=a("1baa"),g=a("f6c4"),_=a("e449"),b=a("f774"),w=a("2fa4"),x=a("8654"),y=a("2a7f"),$=a("3a2f"),k=function(){var t=this,e=t._self._c;return e(i["a"],[e(b["a"],{attrs:{temporary:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[e(m["a"],[e(p["a"],{attrs:{link:"",href:"#/"}},[e(h["a"],[e(u["a"],[t._v(t._s(t.mdiContentPaste))])],1),e(f["a"],[e(f["c"],[t._v("剪贴板")])],1)],1),e(p["a"],{attrs:{link:"",href:"#/device"}},[e(h["a"],[e(u["a"],[t._v(t._s(t.mdiDevices))])],1),e(f["a"],[e(f["c"],[t._v("设备列表")])],1)],1),e(_["a"],{attrs:{"offset-x":"",transition:"slide-x-transition","open-on-click":"","open-on-hover":"","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(p["a"],t._g({attrs:{link:""}},a),[e(h["a"],[e(u["a"],[t._v(t._s(t.mdiBrightness4))])],1),e(f["a"],[e(f["c"],[t._v("深色模式")])],1)],1)]}}])},[e(m["a"],{attrs:{"two-line":""}},[e(v["a"],{attrs:{color:"primary",mandatory:""},model:{value:t.$root.dark,callback:function(e){t.$set(t.$root,"dark",e)},expression:"$root.dark"}},[e(p["a"],{attrs:{link:"",value:"time"}},[e(f["a"],[e(f["c"],[t._v("根据时间切换")]),e(f["b"],[t._v("在 19:00 到次日 7:00 期间启用")])],1)],1),e(p["a"],{attrs:{link:"",value:"prefer"}},[e(f["a"],[e(f["c"],[t._v("根据系统设置切换")]),e(f["b"],[t._v("使用 "),e("code",[t._v("prefers-color-scheme")]),t._v(" 检测")])],1)],1),e(p["a"],{attrs:{link:"",value:"enable"}},[e(f["a"],[e(f["c"],[t._v("保持启用")])],1)],1),e(p["a"],{attrs:{link:"",value:"disable"}},[e(f["a"],[e(f["c"],[t._v("保持禁用")])],1)],1)],1)],1)],1),e(p["a"],{attrs:{link:"",href:"#/about"}},[e(h["a"],[e(u["a"],[t._v(t._s(t.mdiInformation))])],1),e(f["a"],[e(f["c"],[t._v("关于")])],1)],1)],1)],1),e(s["a"],{attrs:{app:"",color:"primary",dark:""}},[e(r["a"],{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),e(y["a"],[t._v("云剪贴板"),t.$root.room?e("span",{staticClass:"d-none d-sm-inline"},[t._v("（房间："),e("abbr",{staticStyle:{cursor:"pointer"},attrs:{title:"点击复制"},on:{click:function(e){t.navigator.clipboard.writeText(t.$root.room).then(()=>t.$toast("已复制房间名称："+t.$root.room).catch(e=>t.$toast.error("复制失败："+e)))}}},[t._v(t._s(t.$root.room))]),t._v("）")]):t._e()]),e(w["a"]),e($["a"],{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:""},on:{click:function(e){t.$root.roomInput=t.$root.room,t.$root.roomDialog=!0}}},a),[e(u["a"],[t._v(t._s(t.mdiBulletinBoard))])],1)]}}])},[e("span",[t._v("进入房间")])]),e($["a"],{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:""},on:{click:function(e){t.$root.websocket||t.$root.websocketConnecting||(t.$root.retry=0,t.$root.connect())}}},a),[t.$root.websocket?e(u["a"],[t._v(t._s(t.mdiLanConnect))]):t.$root.websocketConnecting?e(u["a"],[t._v(t._s(t.mdiLanPending))]):e(u["a"],[t._v(t._s(t.mdiLanDisconnect))])],1)]}}])},[t.$root.websocket?e("span",[t._v("已连接")]):t.$root.websocketConnecting?e("span",[t._v("连接中")]):e("span",[t._v("未连接，点击重连")])])],1),e(g["a"],[t.$route.meta.keepAlive?[e("keep-alive",[e("router-view")],1)]:e("router-view")],2),e(d["a"],{attrs:{persistent:"","max-width":"360"},model:{value:t.$root.authCodeDialog,callback:function(e){t.$set(t.$root,"authCodeDialog",e)},expression:"$root.authCodeDialog"}},[e(l["a"],[e(c["c"],{staticClass:"headline"},[t._v("需要认证")]),e(c["b"],[e("p",[t._v("这个剪贴板服务并不是公开的，请输入密码以继续连接。")]),e(x["a"],{attrs:{label:"密码"},model:{value:t.$root.authCode,callback:function(e){t.$set(t.$root,"authCode",e)},expression:"$root.authCode"}})],1),e(c["a"],[e(w["a"]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$root.authCodeDialog=!1,t.$root.connect()}}},[t._v("提交")])],1)],1)],1),e(d["a"],{attrs:{persistent:"","max-width":"360"},model:{value:t.$root.roomDialog,callback:function(e){t.$set(t.$root,"roomDialog",e)},expression:"$root.roomDialog"}},[e(l["a"],[e(c["c"],{staticClass:"headline"},[t._v("剪贴板房间")]),e(c["b"],[e("p",[t._v("输入任意名称创建新房间，或进入已有的房间。留空则表示使用默认的全局房间。")]),e("p",[t._v("在房间中发送的内容仅限房间内可见，保存的历史记录数量仍然会受到全局设定的限制。")]),e(x["a"],{attrs:{label:"房间名称","append-icon":t.mdiDiceMultiple},on:{"click:append":function(e){t.$root.roomInput=["reimu","marisa","rumia","cirno","meiling","patchouli","sakuya","remilia","flandre","letty","chen","lyrica","lunasa","merlin","youmu","yuyuko","ran","yukari","suika","mystia","keine","tewi","reisen","eirin","kaguya","mokou"][Math.floor(26*Math.random())]+"-"+Math.random().toString(16).substring(2,6)}},model:{value:t.$root.roomInput,callback:function(e){t.$set(t.$root,"roomInput",e)},expression:"$root.roomInput"}})],1),e(c["a"],[e(w["a"]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$root.roomDialog=!1}}},[t._v("取消")]),e(n["a"],{attrs:{color:"primary darken-1",text:""},on:{click:function(e){t.$root.room=t.$root.roomInput,t.$root.roomDialog=!1,t.$root.disconnect(),t.$root.connect()}}},[t._v("进入房间")])],1)],1)],1)],1)},C=[],S=a("94ed"),P={data(){return{drawer:!1,mdiContentPaste:S["j"],mdiDevices:S["k"],mdiInformation:S["q"],mdiLanConnect:S["r"],mdiLanDisconnect:S["s"],mdiLanPending:S["t"],mdiBrightness4:S["d"],mdiBulletinBoard:S["e"],mdiDiceMultiple:S["l"],navigator:navigator}}},D=P,O=a("2877"),I=Object(O["a"])(D,k,C,!1,null,null,null),z=I.exports,T=a("8c4f"),A=a("62ad"),L=a("a523"),j=a("ce7e"),M=a("0789"),F=a("0fd9"),U=a("c73b"),B=a("71d9"),R=function(){var t=this,e=t._self._c;return e(L["a"],[e(F["a"],[e(A["a"],{staticClass:"hidden-sm-and-down",attrs:{cols:"12",md:"4"}},[e("send-text"),e(j["a"],{staticClass:"my-4"}),e("send-file")],1),e(A["a"],{attrs:{cols:"12",md:"8"}},[e(M["b"],{attrs:{group:""}},t._l(t.$root.received,(function(t){return e("received-"+t.type,{key:t.id,tag:"div",attrs:{meta:t}})})),1),e("div",{staticClass:"text-center caption text--secondary py-2"},[t._v(t._s(t.$root.received.length?"已经到底了哦～":"这里空空的"))])],1)],1),e(U["a"],{staticClass:"hidden-md-and-up",staticStyle:{transform:"translateY(-64px)"},attrs:{bottom:"",right:"",fixed:"",direction:"top",transition:"scale-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[e(n["a"],{attrs:{fab:"",dark:"",color:"primary"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[e(u["a"],[t._v(t._s(t.mdiPlus))])],1)]},proxy:!0}]),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[e(n["a"],{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){t.dialog=!0,t.mode="file"}}},[e(u["a"],[t._v(t._s(t.mdiFileDocumentOutline))])],1),e(n["a"],{attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(e){t.dialog=!0,t.mode="text"}}},[e(u["a"],[t._v(t._s(t.mdiText))])],1)],1),e(d["a"],{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[e(l["a"],[e(B["a"],{staticClass:"flex-grow-0",attrs:{dark:"",color:"primary"}},[e(n["a"],{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[e(u["a"],[t._v(t._s(t.mdiClose))])],1),"text"===t.mode?e(y["a"],[t._v("发送文本")]):t._e(),"file"===t.mode?e(y["a"],[t._v("发送文件")]):t._e(),e(w["a"])],1),e(c["b"],{staticClass:"px-4"},[e("div",{staticClass:"my-4"},["text"===t.mode?e("send-text"):t._e(),"file"===t.mode?e("send-file"):t._e()],1)])],1)],1)],1)},V=[],N=a("a844"),H=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"headline text--primary mb-4"},[t._v("发送文本")]),e(N["a"],{attrs:{"no-resize":"",outlined:"",dense:"",rows:"6",counter:t.$root.config.text.limit,placeholder:"请输入需要发送的文本"},model:{value:t.$root.send.text,callback:function(e){t.$set(t.$root.send,"text",e)},expression:"$root.send.text"}}),e("div",{staticClass:"text-right"},[e(n["a"],{attrs:{color:"primary",block:t.$vuetify.breakpoint.smAndDown,disabled:!t.$root.send.text||!t.$root.websocket||t.$root.send.text.length>t.$root.config.text.limit},on:{click:t.send}},[t._v("发送")])],1)],1)},W=[],G=(a("88a7"),a("271a"),a("5494"),{name:"send-text",methods:{send(){this.$http.post("text",this.$root.send.text,{params:new URLSearchParams([["room",this.$root.room]]),headers:{"Content-Type":"text/plain"}}).then(t=>{this.$toast("发送成功"),this.$root.send.text=""}).catch(t=>{t.response&&t.response.data.msg?this.$toast("发送失败："+t.response.data.msg):this.$toast("发送失败")})}}}),J=G,E=Object(O["a"])(J,H,W,!1,null,null,null),Y=E.exports,q=a("adda"),K=a("8e36"),Q=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"headline text--primary mb-4"},[t._v("发送文件")]),e(l["a"],{staticClass:"pa-3 mb-6 d-flex flex-row align-center",attrs:{outlined:""},on:{dragenter:function(t){return t.preventDefault()},dragover:function(t){return t.preventDefault()},dragleave:function(t){return t.preventDefault()},drop:function(e){e.preventDefault(),t.handleSelectFiles(Array.from(e.dataTransfer.files))}}},[t.$root.send.files.length?[t.progress?[e("div",{staticClass:"flex-grow-1"},[e("small",{staticClass:"d-block text-right text--secondary"},[t._v(" "+t._s(t._f("prettyFileSize")(Math.min(t.uploadedSize,t.fileSize)))+" / "+t._s(t._f("prettyFileSize")(t.fileSize))+" ("+t._s(t._f("percentage")(t.uploadProgress))+") ")]),e(K["a"],{attrs:{value:100*t.uploadProgress}})],1)]:[t.isUploadingImage?e(q["a"],{staticClass:"mr-3 flex-grow-0",staticStyle:{"border-radius":"3px"},attrs:{src:t.imagePreview,width:"2.5rem",height:"2.5rem"}}):t._e(),e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"text-truncate",attrs:{title:t.$root.send.files[0].name+" "+(t.$root.send.files.length>1?`等 ${t.$root.send.files.length} 个文件`:"")}},[t._v(t._s(t.$root.send.files[0].name)+" "+t._s(t.$root.send.files.length>1?`等 ${t.$root.send.files.length} 个文件`:"")+" ")]),e("div",{staticClass:"caption"},[t._v(t._s(t._f("prettyFileSize")(t.fileSize)))])]),e("div",{staticClass:"align-self-center"},[e(n["a"],{attrs:{icon:"",color:"grey"},on:{click:function(e){return t.$root.send.files.splice(0)}}},[e(u["a"],[t._v(t._s(t.mdiClose))])],1)],1)]]:[e(n["a"],{staticClass:"d-block mx-auto",attrs:{text:"",color:"primary",large:""},on:{click:function(e){return t.$refs.selectFile.click()}}},[e("div",{attrs:{title:"支持拖拽和 Ctrl+V 粘贴截图"}},[t._v(" 选择要发送的文件"),e("span",{staticClass:"d-none d-xl-inline"},[t._v("（支持拖拽和 Ctrl+V 粘贴截图）")]),e("br"),e("small",{staticClass:"text--secondary"},[t._v("文件大小限制："+t._s(t._f("prettyFileSize")(t.$root.config.file.limit)))])])]),e("input",{ref:"selectFile",staticClass:"d-none",attrs:{type:"file",multiple:""},on:{change:function(e){t.handleSelectFiles(Array.from(e.target.files))}}})]],2),e("div",{staticClass:"text-right"},[e(n["a"],{attrs:{color:"primary",block:t.$vuetify.breakpoint.smAndDown,disabled:!t.$root.send.files.length||!t.$root.websocket||t.progress},on:{click:t.send}},[t._v("发送")])],1)],1)},X=[];a("14d9"),a("13d5");function Z(t){let e=["TB","GB","MB","KB"],a="Bytes";while(t>=1024&&e.length)t/=1024,a=e.pop();return`${Math.floor(100*t)/100} ${a}`}function tt(t,e=2){return(100*t).toFixed(e)+"%"}function et(t){let e=new Date(1e3*t);return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,0)+"-"+e.getDate().toString().padStart(2,0)+" "+e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0)+":"+e.getSeconds().toString().padStart(2,0)}var at={name:"send-file",data(){return{progress:!1,uploadedSizes:[],imagePreview:"",uploading:!1,mdiClose:S["h"]}},computed:{fileSize(){return this.$root.send.files.length?this.$root.send.files.reduce((t,e)=>t+e.size,0):0},uploadedSize(){return this.uploadedSizes.length?this.uploadedSizes.reduce((t,e)=>t+e,0):0},uploadProgress(){return Math.min(0!==this.fileSize?this.uploadedSize/this.fileSize:0,1)},isUploadingImage(){return this.$root.send.files.length&&this.$root.send.files[0].type.startsWith("image/")}},methods:{handleSelectFiles(t){t.some(t=>!t.size)?this.$toast("不能发送空文件"):t.some(t=>t.size>this.$root.config.file.limit)?this.$toast(`文件大小超过限制（${Z(this.$root.config.file.limit)}）`):(this.$root.send.files.splice(0),this.$root.send.files.push(...t),this.isUploadingImage&&(URL.revokeObjectURL(this.imagePreview),this.imagePreview=URL.createObjectURL(t[0])))},async send(){try{const t=this.$root.config.file.chunk;this.uploadedSizes.splice(0),this.uploadedSizes.push(...Array(this.$root.send.files.length).fill(0)),await Promise.all(this.$root.send.files.map(async(e,a)=>{let o=await this.$http.post("upload",e.name,{headers:{"Content-Type":"text/plain"}}),i=o.data.result.uuid,s=0;this.progress=!0;while(s<e.size){let o=e.slice(s,s+t);await this.$http.post("upload/chunk/"+i,o,{headers:{"Content-Type":"application/octet-stream"},onUploadProgress:t=>this.$set(this.uploadedSizes,a,s+t.loaded)}),s+=t}await this.$http.post("upload/finish/"+i,null,{params:new URLSearchParams([["room",this.$root.room]])})})),this.$toast("发送成功"),this.$root.send.files.splice(0)}catch(t){t.response&&t.response.data.msg?this.$toast("发送失败："+t.response.data.msg):this.$toast("发送失败")}finally{this.progress=!1}}},mounted(){document.onpaste=t=>{if(!t||!t.clipboardData)return;console.log(t.clipboardData);const e=Array.from(t.clipboardData.items);e.length&&e.every(t=>"file"===t.kind)&&this.handleSelectFiles(e.map(t=>t.getAsFile()))}}},ot=at,it=Object(O["a"])(ot,Q,X,!1,null,null,null),st=it.exports,rt=a("ce87"),nt=function(){var t=this,e=t._self._c;return e(rt["a"],{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return[e(l["a"],{staticClass:"mb-2 transition-swing",attrs:{elevation:a?6:2}},[e(c["b"],[e("div",{staticClass:"d-flex flex-row align-center"},[e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"title text-truncate text--primary",on:{click:function(e){t.expand=!t.expand}}},[t._v(" 文本消息"),e(u["a"],[t._v(t._s(t.expand?t.mdiChevronUp:t.mdiChevronDown))])],1),e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"text-truncate",domProps:{innerHTML:t._s(t.meta.content.trim())},on:{click:function(e){t.expand=!t.expand}}})]),e("div",{staticClass:"align-self-center text-no-wrap"},[e($["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:t.copyText}},a),[e(u["a"],[t._v(t._s(t.mdiContentCopy))])],1)]}}],null,!0)},[e("span",[t._v("复制")])]),e($["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:t.deleteItem}},a),[e(u["a"],[t._v(t._s(t.mdiClose))])],1)]}}],null,!0)},[e("span",[t._v("删除")])])],1)]),e(M["a"],[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"expand"}]},[e(j["a"],{staticClass:"my-2"}),e("div",{directives:[{name:"linkified",rawName:"v-linkified"}],ref:"content",domProps:{innerHTML:t._s(t.meta.content.replace(/\n/g,"<br>"))}})],1)])],1)],1)]}}])})},lt=[],ct={name:"received-text",props:{meta:{type:Object,default(){return{}}}},data(){return{expand:!1,mdiChevronUp:S["g"],mdiChevronDown:S["f"],mdiContentCopy:S["i"],mdiClose:S["h"]}},methods:{copyText(){let t=document.createElement("textarea");t.value=(new DOMParser).parseFromString(this.meta.content,"text/html").documentElement.textContent,t.style.cssText="top:0;left:0;position:fixed",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t),this.$toast("复制成功")},deleteItem(){this.$http.delete("revoke/"+this.meta.id,{params:new URLSearchParams([["room",this.$root.room]])}).then(()=>{this.$toast("已删除文本消息")}).catch(t=>{t.response&&t.response.data.msg?this.$toast("消息删除失败："+t.response.data.msg):this.$toast("消息删除失败")})}}},dt=ct,ut=Object(O["a"])(dt,nt,lt,!1,null,null,null),mt=ut.exports,pt=a("490a"),ht=function(){var t=this,e=t._self._c;return e(rt["a"],{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return[e(l["a"],{staticClass:"mb-2 transition-swing",attrs:{elevation:a?6:2}},[e(c["b"],[e("div",{staticClass:"d-flex flex-row align-center"},[t.meta.thumbnail?e(q["a"],{staticClass:"mr-3 flex-grow-0 hidden-sm-and-down",staticStyle:{"border-radius":"3px"},attrs:{src:t.meta.thumbnail,width:"2.5rem",height:"2.5rem"}}):t._e(),e("div",{staticClass:"flex-grow-1 mr-2",staticStyle:{"min-width":"0"}},[e("div",{staticClass:"title text-truncate text--primary",style:{"text-decoration":t.expired?"line-through":""},attrs:{title:t.meta.name}},[t._v(t._s(t.meta.name))]),e("div",{staticClass:"caption"},[t._v(" "+t._s(t._f("prettyFileSize")(t.meta.size))+" "),t.$vuetify.breakpoint.smAndDown?[e("br")]:[t._v("|")],t._v(" "+t._s(t.expired?"已":"将")+"于 "+t._s(t._f("formatTimestamp")(t.meta.expire))+" 过期 ")],2)]),e("div",{staticClass:"align-self-center text-no-wrap"},[e($["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey",href:t.expired?null:"/file/"+t.meta.cache,download:t.expired?null:t.meta.name}},a),[e(u["a"],[t._v(t._s(t.expired?t.mdiDownloadOff:t.mdiDownload))])],1)]}}],null,!0)},[e("span",[t._v(t._s(t.expired?"已过期":"下载"))])]),t.meta.thumbnail||t.isPreviewableVideo||t.isPreviewableAudio?[t.loadingPreview?e(pt["a"],{attrs:{indeterminate:"",color:"grey"}},[t._v(t._s(t._f("percentage")(t.loadedPreview/t.meta.size,0)))]):t._e(),e($["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey"},on:{click:function(e){!t.expired&&t.previewFile()}}},a),[e(u["a"],[t._v(t._s(t.isPreviewableVideo||t.isPreviewableAudio?t.mdiMovieSearchOutline:t.mdiImageSearchOutline))])],1)]}}],null,!0)},[e("span",[t._v("预览")])])]:t._e(),e($["a"],{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(n["a"],t._g({attrs:{icon:"",color:"grey",disabled:t.loadingPreview},on:{click:t.deleteItem}},a),[e(u["a"],[t._v(t._s(t.mdiClose))])],1)]}}],null,!0)},[e("span",[t._v("删除")])])],2)],1),t.meta.thumbnail||t.isPreviewableVideo||t.isPreviewableAudio?e(M["a"],[e("div",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"expand"}]},[e(j["a"],{staticClass:"my-2"}),t.isPreviewableVideo?e("video",{staticClass:"rounded d-block mx-auto",staticStyle:{"max-height":"480px","max-width":"100%"},attrs:{src:t.srcPreview,controls:"",preload:"metadata"}}):t.isPreviewableAudio?e("audio",{staticClass:"rounded d-block mx-auto",staticStyle:{width:"100%"},attrs:{src:t.srcPreview,controls:"",preload:"metadata"}}):e("img",{staticClass:"rounded d-block mx-auto",staticStyle:{"max-height":"480px","max-width":"100%"},attrs:{src:t.srcPreview}})],1)]):t._e()],1)],1)]}}])})},ft=[],vt={name:"received-file",props:{meta:{type:Object,default(){return{}}}},data(){return{loadingPreview:!1,loadedPreview:0,expand:!1,srcPreview:null,mdiContentCopy:S["i"],mdiDownload:S["m"],mdiDownloadOff:S["n"],mdiClose:S["h"],mdiImageSearchOutline:S["p"],mdiMovieSearchOutline:S["x"]}},computed:{expired(){return this.$root.date.getTime()/1e3>this.meta.expire},isPreviewableVideo(){return this.meta.name.match(/\.(mp4|webm|ogv)$/gi)},isPreviewableAudio(){return this.meta.name.match(/\.(wav|ogg|opus|m4a|flac)$/gi)}},methods:{previewFile(){this.expand?this.expand=!1:this.srcPreview?this.expand=!0:(this.expand=!0,this.isPreviewableVideo||this.isPreviewableAudio?this.srcPreview="file/"+this.meta.cache:(this.loadingPreview=!0,this.loadedPreview=0,this.$http.get("file/"+this.meta.cache,{responseType:"arraybuffer",onDownloadProgress:t=>{this.loadedPreview=t.loaded}}).then(t=>{this.srcPreview=URL.createObjectURL(new Blob([t.data]))}).catch(t=>{t.response&&t.response.data.msg?this.$toast("文件获取失败："+t.response.data.msg):this.$toast("文件获取失败")}).finally(()=>{this.loadingPreview=!1})))},deleteItem(){this.$http.delete("revoke/"+this.meta.id,{params:new URLSearchParams([["room",this.$root.room]])}).then(()=>{this.expired||this.$http.delete("file/"+this.meta.cache).then(()=>{this.$toast("已删除文件 "+this.meta.name)}).catch(t=>{t.response&&t.response.data.msg?this.$toast("文件删除失败："+t.response.data.msg):this.$toast("文件删除失败")})}).catch(t=>{t.response&&t.response.data.msg?this.$toast("消息删除失败："+t.response.data.msg):this.$toast("消息删除失败")})}}},gt=vt,_t=Object(O["a"])(gt,ht,ft,!1,null,null,null),bt=_t.exports,wt={components:{SendText:Y,SendFile:st,ReceivedText:mt,ReceivedFile:bt},data(){return{fab:!1,dialog:!1,mode:null,mdiPlus:S["y"],mdiFileDocumentOutline:S["o"],mdiText:S["A"],mdiClose:S["h"]}}},xt=wt,yt=Object(O["a"])(xt,R,V,!1,null,null,null),$t=yt.exports,kt=a("8270"),Ct=a("6b53"),St=function(){var t=this,e=t._self._c;return e(L["a"],[e(Ct["a"],{staticClass:"mx-auto",attrs:{"max-width":"640"}},[e("div",{staticClass:"headline text--primary my-4"},[t._v("已连接的设备列表")]),t.$root.websocket?[t._v(" 已有 "+t._s(t.$root.device.length)+" 个设备连接，桌面端设备 "+t._s(t.desktopDeviceCount)+" 个，移动端设备 "+t._s(t.mobileDeviceCount)+" 个。 "),e(j["a"],{staticClass:"my-2"})]:[t._v(" 未连接到服务器。 ")],e(m["a"],{attrs:{rounded:"","two-line":""}},[e(v["a"],{attrs:{color:"primary"}},t._l(t.$root.device,(function(a){return e(p["a"],{key:a.id},[e(kt["a"],{attrs:{tile:""}},["desktop"===a.type?["Windows"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiMicrosoftWindows))]):"GNU/Linux"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiLinux))]):"Mac"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiApple))]):e(u["a"],[t._v(t._s(t.mdiLaptop))])]:"smartphone"===a.type||"mobile"===a.type||"tablet"===a.type?["Android"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiAndroid))]):"iOS"===a.os.split(" ").shift()?e(u["a"],[t._v(t._s(t.mdiAppleIos))]):e(u["a"],[t._v(t._s(t.mdiTabletCellphone))])]:e(u["a"],[t._v(t._s(t.mdiDevices))])],2),e(f["a"],[e(f["c"],[t._v(t._s("desktop"===a.type?"桌面端设备":a.device||("smartphone"===a.type||"mobile"===a.type||"tablet"===a.type?"移动端设备":"其他类型设备")))]),e(f["b"],[t._v(t._s(a.os)+" ("+t._s(a.browser)+")")])],1)],1)})),1)],1)],2)],1)},Pt=[],Dt={data(){return{mdiLaptop:S["u"],mdiMicrosoftWindows:S["w"],mdiApple:S["b"],mdiLinux:S["v"],mdiTabletCellphone:S["z"],mdiAndroid:S["a"],mdiAppleIos:S["c"],mdiDevices:S["k"]}},computed:{desktopDeviceCount(){return this.$root.device.filter(t=>"desktop"===t.type).length},mobileDeviceCount(){return this.$root.device.filter(t=>"smartphone"===t.type||"tablet"===t.type).length}}},Ot=Dt,It=Object(O["a"])(Ot,St,Pt,!1,null,null,null),zt=It.exports,Tt=function(){var t=this,e=t._self._c;return e(L["a"],{attrs:{"fill-height":""}},[e(F["a"],{staticClass:"pa-3",attrs:{justify:"center",align:"center"}},[e("div",{staticClass:"text-center"},[e("div",{staticClass:"headline my-4"},[t._v("Cloud Clipboard "+t._s(t.$root.config.version))]),t._v(" 在局域网内互传纯文本和文件的云剪贴板 "),e("br"),t._v(" 即开即用的网页版，无须安装 APP "),e("br"),e("a",{attrs:{href:"https://github.com/TransparentLC/cloud-clipboard",target:"_blank"}},[t._v("GitHub")])])])],1)},At=[],Lt={},jt=Lt,Mt=Object(O["a"])(jt,Tt,At,!1,null,null,null),Ft=Mt.exports;o["a"].use(T["a"]);const Ut=new T["a"]({routes:[{path:"/",component:$t,meta:{keepAlive:!0}},{path:"/device",component:zt,meta:{keepAlive:!0}},{path:"/about",component:Ft,meta:{keepAlive:!0}}]});var Bt=Ut,Rt=a("f309"),Vt=a("2db4"),Nt=a("87f6"),Ht=a.n(Nt);const Wt=new Rt["a"]({icons:{iconfont:"mdiSvg"}});o["a"].use(Rt["a"],{components:{VSnackbar:Vt["a"],VBtn:n["a"],VIcon:u["a"]}}),o["a"].use(Ht.a,{$vuetify:Wt.framework,x:"",color:"",closeText:"关闭",closeColor:"accent"});var Gt=Wt,Jt={data(){return{websocket:null,websocketConnecting:!1,authCode:localStorage.getItem("auth")||"",authCodeDialog:!1,room:localStorage.getItem("room")||"",roomInput:"",roomDialog:!1,retry:0,event:{receive:t=>{this.$root.received.unshift(t)},revoke:t=>{let e=this.$root.received.findIndex(e=>e.id===t.id);-1!==e&&this.$root.received.splice(e,1)},config:t=>{this.$root.config=t,console.log(`%c Cloud Clipboard ${t.version} by TransparentLC %c https://github.com/TransparentLC/cloud-clipboard `,"color:#fff;background-color:#1e88e5","color:#fff;background-color:#64b5f6")},connect:t=>{this.$root.device.push(t)},disconnect:t=>{let e=this.$root.device.findIndex(e=>e.id===t.id);-1!==e&&this.$root.device.splice(e,1)},forbidden:()=>{this.authCode="",localStorage.removeItem("auth")}}}},methods:{connect(){this.websocketConnecting=!0,this.$toast(this.retry?`未能连接到服务器，正在尝试第 ${this.retry} 次重连……`:"正在连接服务器……",{showClose:!1,dismissable:!1,timeout:0}),this.$http.get("server").then(t=>(this.authCode&&localStorage.setItem("auth",this.authCode),this.room=this.room.trim(),localStorage.setItem("room",this.room),new Promise((e,a)=>{const o=new URL(t.data.server);if(o.protocol="https:"===location.protocol?"wss:":"ws:",t.data.auth){if(!this.authCode)return void(this.authCodeDialog=!0);o.searchParams.set("auth",this.authCode)}o.searchParams.set("room",this.room);const i=new WebSocket(o);i.onopen=()=>e(i),i.onerror=a}))).then(t=>{this.websocketConnecting=!1,this.retry=0,this.received=[],this.$toast("连接服务器成功"),setInterval(()=>{t.send("")},3e4),t.onclose=()=>{this.failure()},t.onmessage=t=>{try{let e=JSON.parse(t.data);(this.event[e.event]||(()=>{}))(e.data)}catch{}},this.websocket=t}).catch(t=>{this.websocketConnecting=!1,this.failure()})},disconnect(){this.websocketConnecting=!1,this.websocket.onclose=()=>{},this.websocket.close(),this.websocket=null,this.$root.device=[]},failure(){this.websocket=null,this.$root.device=[],this.retry++<3?this.connect():this.$toast.error("连接服务器失败，请点击工具栏上的“连接”图标重试",{showClose:!1,dismissable:!1,timeout:0})}},mounted(){this.connect()}},Et=a("cee4"),Yt=a("a7fe"),qt=a.n(Yt),Kt=a("9aa5"),Qt=a.n(Kt);a("d4b8");o["a"].config.productionTip=!1,o["a"].use(qt.a,Et["a"]),o["a"].directive("linkified",Qt.a),o["a"].filter("prettyFileSize",Z),o["a"].filter("percentage",tt),o["a"].filter("formatTimestamp",et),new o["a"]({mixins:[Jt],data(){return{date:new Date,dark:null,config:{version:"",text:{limit:0},file:{expire:0,chunk:0,limit:0}},send:{text:"",files:[]},received:[],device:[]}},router:Bt,vuetify:Gt,render:t=>t(z),watch:{dark(t){this.$vuetify.theme.dark=this.useDark,localStorage.setItem("darkmode",t)}},computed:{useDark:{cache:!1,get(){switch(this.dark){case"enable":return!0;case"disable":return!1;case"time":let t=this.date.getHours();return t>=19||t<7;case"prefer":return matchMedia("(prefers-color-scheme:dark)").matches;default:return!1}}}},mounted(){this.dark=localStorage.getItem("darkmode")||"prefer",this.$vuetify.theme.dark=this.useDark,setInterval(()=>{this.date=new Date,this.$vuetify.theme.dark=this.useDark},1e3)}}).$mount("#app")}});